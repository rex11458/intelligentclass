(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-138d0c96"],{5996:function(t,n,e){},a5b7:function(t,n,e){t.exports=e.p+"img/boy_img.8267a8ec.png"},d672:function(t,n,e){"use strict";var a=e("5996"),s=e.n(a);s.a},f50f:function(t,n,e){"use strict";e.r(n);var a=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"course-random"},[e("head-top",{attrs:{title:"第"+t.realPickIndex+"次随机挑人"}}),e("div",{staticClass:"sub_nav"},[e("span",[t._v("选中成员")]),e("van-button",{directives:[{name:"show",rawName:"v-show",value:t.randomStudents.length>0&&1===t.randomPickState,expression:"randomStudents.length>0 && randomPickState === 1"}],attrs:{type:"danger",size:"small",disabled:t.isLoading},on:{click:t.stop}},[t._v(" 结束挑人 ")])],1),e("div",{staticClass:"sub_module"},[0===t.randomStudents.length?e("span",[t._v("暂无数据")]):e("div",{staticClass:"flex-wrap-between"},[t._l(t.randomStudents,(function(n,a){return e("div",{key:a,staticClass:"student_card van-hairline--surround"},[e("img",{staticClass:"col_4",attrs:{src:n.imgSrc,alt:""}}),e("div",[t._v(t._s(n.studentName))])])})),t._l(Math.abs(4-t.randomStudents.length%4)%4,(function(t){return e("div",{key:-t,staticClass:"student_card",staticStyle:{width:"19vw"}})}))],2)]),e("div",{staticClass:"sub_nav"},[e("span",[t._v("课堂成员")]),e("van-radio-group",{attrs:{direction:"horizontal"},model:{value:t.studentType,callback:function(n){t.studentType=n},expression:"studentType"}},[e("van-radio",{attrs:{name:1}},[t._v("全部")]),e("van-radio",{attrs:{name:2}},[t._v("签到")])],1),e("van-button",{attrs:{type:"primary",size:"small",disabled:t.isLoading||t.randomStudents.length>=t.studentSelectedList.length},on:{click:t.toRandom}},[t._v(" "+t._s(t.randomStudents.length>0?"重新挑人":"开始挑人")+" ")])],1),e("div",{staticClass:"sub_module"},[0===t.studentSelectedList.length?e("span",[t._v("暂无数据")]):e("div",{staticClass:"flex-wrap-between"},[t._l(t.studentSelectedList,(function(n,a){return e("div",{key:a,staticClass:"student_card van-hairline--surround",class:{active:t.activeIndex===a}},[e("img",{staticClass:"col_4",attrs:{src:n.imgSrc,alt:""}}),e("div",[t._v(t._s(n.studentName))])])})),t._l(Math.abs(4-t.studentSelectedList.length%4)%4,(function(t){return e("div",{key:-t,staticClass:"student_card",staticStyle:{width:"19vw"}})}))],2)])],1)},s=[],i=(e("4de4"),e("c740"),e("4160"),e("ac1f"),e("5319"),e("159b"),e("a5b7")),d=e.n(i),o={name:"randomPerson",data:function(){return{studentList:[],randomStudents:[],activeIndex:-1,isLoading:!1,studentType:1,randomPickIndex:1,randomPickID:"",randomPickState:1,pickStudentID:""}},computed:{realPickIndex:function(){return this.randomPickIndex+(2===this.randomPickState?1:0)},studentSelectedList:function(){return 1===this.studentType?this.studentList:this.studentList.filter((function(t){return 1===t.signState}))}},mounted:function(){this.getStudent(),this.getRandomInfo()},methods:{getStudent:function(){var t=this;this.studentList=[],this.$gatewayHttp.student.getDataList().then((function(n){n.Result&&n.Datas?n.Datas.forEach((function(n){t.studentList.push({imgSrc:d.a,studentID:n["StudentID"],studentName:n["StudentName"],studentSno:n["StudentXH"],signState:n["SignState"]})})):n.Info&&t.$toast(n.Info)})).catch((function(){}))},getRandomInfo:function(){var t=this;this.$gatewayHttp.randomPick.getDataInfo({ciID:this.$store.getters.courseID}).then((function(n){n.Result&&n.Data?(t.randomPickIndex=n.Data["RPSerial"],t.randomPickID=n.Data["RPID"],t.randomPickState=n.Data["State"],t.getRandomList()):n.Info&&t.$toast(n.Info)})).catch((function(){}))},getRandomList:function(){var t=this;this.randomStudents=[],this.$gatewayHttp.randomPick.getSelectResult({rpID:this.randomPickID,rpState:this.randomPickState}).then((function(n){n.Result&&n.Datas?(n.Datas.sort((function(t,n){return t["CreateTime"]>n["CreateTime"]?-1:1})),n.Datas.forEach((function(n){t.randomStudents.push({imgSrc:d.a,studentID:n["StudentID"],studentName:n["StudentName"],studentSno:n["StudentXH"]})}))):n.Info&&t.$toast(n.Info)})).catch((function(){}))},toRandom:function(){var t=this;this.pickStudentID="";var n=setInterval((function(){t.activeIndex=t.randomIndex(t.studentList.length-1)}),90);this.$gatewayHttp.randomPick.startPick({studentType:this.studentType}).then((function(e){if(e.Result){t.randomPickState=1,t.pickStudentID=e["StudentID"];var a=t.studentList.findIndex((function(n){return n.studentID===t.pickStudentID}));t.activeIndex=a,a>-1&&t.randomStudents.push(t.studentList[a]),setTimeout((function(){t.activeIndex=-1}),90),t.$toast("挑选成功")}else e.Info?t.$toast(e.Info):t.$toast("开始挑人失败");clearInterval(n)})).catch((function(){t.$toast("操作失败"),clearInterval(n)}))},randomIndex:function(t){return Math.round(t*Math.random())},stop:function(){var t=this;this.$gatewayHttp.randomPick.stopPick().then((function(n){n.Result?(t.$toast("结束挑人成功"),t.$router.replace("/course/power")):n.Info?t.$toast(n.Info):t.$toast("结束挑人失败")})).catch((function(){t.$toast("操作失败")}))}},beforeDestroy:function(){clearTimeout()}},u=o,c=(e("d672"),e("2877")),r=Object(c["a"])(u,a,s,!1,null,"21473538",null);n["default"]=r.exports}}]);
//# sourceMappingURL=chunk-138d0c96.ead56227.js.map