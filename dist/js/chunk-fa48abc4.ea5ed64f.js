(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-fa48abc4"],{"20bb":function(t,e,n){},a73a:function(t,e,n){"use strict";var s=n("20bb"),a=n.n(s);a.a},f50f:function(t,e,n){"use strict";n.r(e);var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"course-random"},[n("head-top",{attrs:{title:"第"+t.realPickIndex+"次随机挑人"}}),n("div",{staticClass:"sub_nav"},[n("span",[t._v("选中成员")]),n("van-button",{directives:[{name:"show",rawName:"v-show",value:t.randomStudents.length>0&&1===t.randomPickState,expression:"randomStudents.length>0 && randomPickState === 1"}],attrs:{type:"danger",size:"mini",disabled:t.isLoading},on:{click:t.stop}},[t._v(" 结束挑人 ")])],1),n("div",{staticClass:"sub_module"},[0===t.randomStudents.length?n("span",[t._v("暂无数据")]):n("div",{staticClass:"flex-wrap-between"},[t._l(t.randomStudents,(function(e,s){return n("div",{key:s,staticClass:"student_card van-hairline--surround"},[n("img",{directives:[{name:"real-img",rawName:"v-real-img",value:[e.userID,e.studentID],expression:"[sub.userID, sub.studentID]"}],staticClass:"col_4",attrs:{src:t.defaultHead,alt:""}}),n("div",[t._v(t._s(e.studentName))])])})),t._l(Math.abs(4-t.randomStudents.length%4)%4,(function(t){return n("div",{key:-t,staticClass:"student_card",staticStyle:{width:"19vw"}})}))],2)]),n("div",{staticClass:"sub_nav"},[n("span",[t._v("课堂成员")]),n("van-radio-group",{attrs:{direction:"horizontal"},model:{value:t.studentType,callback:function(e){t.studentType=e},expression:"studentType"}},[n("van-radio",{attrs:{name:1}},[t._v("全部")]),n("van-radio",{attrs:{name:2}},[t._v("签到")])],1),n("van-button",{attrs:{type:"primary",size:"mini",disabled:t.isLoading||t.randomStudents.length>=t.studentSelectedList.length},on:{click:t.toRandom}},[t._v(" "+t._s(t.randomStudents.length>0?"重新挑人":"开始挑人")+" ")])],1),n("div",{staticClass:"sub_module"},[0===t.studentSelectedList.length?n("span",[t._v("暂无数据")]):n("div",{staticClass:"flex-wrap-between"},[t._l(t.studentSelectedList,(function(e,s){return n("div",{key:s,staticClass:"student_card van-hairline--surround",class:{active:t.activeIndex===s}},[n("img",{directives:[{name:"real-img",rawName:"v-real-img",value:[e.userID,e.studentID],expression:"[sub.userID, sub.studentID]"}],staticClass:"col_4",attrs:{src:t.defaultHead,alt:""}}),n("div",[t._v(t._s(e.studentName))])])})),t._l(Math.abs(4-t.studentSelectedList.length%4)%4,(function(t){return n("div",{key:-t,staticClass:"student_card",staticStyle:{width:"19vw"}})}))],2)])],1)},a=[],i=(n("4de4"),n("c740"),n("4160"),n("ac1f"),n("5319"),n("159b"),{name:"randomPerson",data:function(){return{defaultHead:n("a5b7"),studentList:[],randomStudents:[],activeIndex:-1,isLoading:!1,studentType:1,randomPickIndex:1,randomPickID:"",randomPickState:1,pickStudentID:""}},computed:{realPickIndex:function(){return this.randomPickIndex+(2===this.randomPickState?1:0)},studentSelectedList:function(){return 1===this.studentType?this.studentList:this.studentList.filter((function(t){return 1===t.signState}))}},mounted:function(){this.getStudent(),this.getRandomInfo()},methods:{getStudent:function(){var t=this;this.studentList=[],this.$mainHttp.class.courseStudents({ciID:this.$store.getters.courseID,classID:this.$store.getters.classID}).then((function(e){e.Result&&e.Datas?e.Datas.forEach((function(e){t.studentList.push({studentID:e.Key["StudentID"],userID:e.Key["UserID"],studentName:e.Key["StudentName"],studentSno:e.Key["StudentXH"],signState:e.Value["SignState"]})})):e.Info&&t.$toast(e.Info)})).catch((function(){}))},getRandomInfo:function(){var t=this;this.$mainHttp.randomPick.getDataInfo({ciID:this.$store.getters.courseID}).then((function(e){e.Result&&e.Data?(t.randomPickIndex=e.Data["RPSerial"],t.randomPickID=e.Data["RPID"],t.randomPickState=e.Data["State"],t.randomPickState+0===1&&t.getRandomList()):e.Info&&t.$toast(e.Info)})).catch((function(){}))},getRandomList:function(){var t=this;this.randomStudents=[],this.$mainHttp.randomPick.getSelectResult({rpID:this.randomPickID}).then((function(e){e.Result&&e.Datas?(e.Datas.sort((function(t,e){return t["CreateTime"]>e["CreateTime"]?-1:1})),e.Datas.forEach((function(e){t.randomStudents.push({studentID:e["StudentID"],userID:e["UserID"],studentName:e["StudentName"],studentSno:e["StudentXH"]})}))):e.Info&&t.$toast(e.Info)})).catch((function(){}))},toRandom:function(){var t=this;this.pickStudentID="";var e=setInterval((function(){t.activeIndex=t.randomIndex(t.studentList.length-1)}),90);this.$mainHttp.randomPick.startPick({ciID:this.$store.getters.courseID,classID:this.$store.getters.classID,type:this.studentType}).then((function(n){if(n.Result){t.randomPickState=1,t.pickStudentID=n.Student["StudentID"];var s=t.studentList.findIndex((function(e){return e.studentID===t.pickStudentID}));t.activeIndex=s,s>-1&&t.randomStudents.push(t.studentList[s]),t.randomPickID||t.getRandomInfo(),setTimeout((function(){t.activeIndex=-1}),90),t.$toast("挑选成功")}else n.Info?t.$toast(n.Info):t.$toast("开始挑人失败");clearInterval(e)})).catch((function(){t.$toast("操作失败"),clearInterval(e)}))},randomIndex:function(t){return Math.round(t*Math.random())},stop:function(){var t=this;this.$mainHttp.randomPick.stopPick({rpID:this.randomPickID}).then((function(e){e.Result?(t.$toast("结束挑人成功"),t.$router.replace("/course/power")):e.Info?t.$toast(e.Info):t.$toast("结束挑人失败")})).catch((function(){t.$toast("操作失败")}))}},beforeDestroy:function(){clearTimeout()}}),d=i,u=(n("a73a"),n("2877")),o=Object(u["a"])(d,s,a,!1,null,"2829f9a6",null);e["default"]=o.exports}}]);