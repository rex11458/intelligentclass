(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f02a9944"],{"13d5":function(t,s,e){"use strict";var i=e("23e7"),o=e("d58f").left,n=e("a640"),a=e("ae40"),c=n("reduce"),r=a("reduce",{1:0});i({target:"Array",proto:!0,forced:!c||!r},{reduce:function(t){return o(this,t,arguments.length,arguments.length>1?arguments[1]:void 0)}})},bbd9:function(t,s,e){"use strict";e.r(s);var i=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"discussion-info"},[e("head-top",{attrs:{title:"小组讨论"}},[(t.titleInfo.state,t._e())]),e("div",{staticClass:"sub_nav"},[e("span",[t._v("当前论题")]),e("div",[e("span",[t._v(" 获赞："+t._s(t.titleInfo.goodTotal||0)+" ")]),e("span",{staticStyle:{"padding-left":"1rem"}},[t._v(" 得分："+t._s(t.titleInfo.scoreTotal||0)+" ")])])]),e("div",{staticClass:"sub_module"},[e("span",{staticClass:"module-title"},[t._v(" 论题"+t._s(t.titleInfo.sort)+"： "),t.titleInfo.titleType===t.defaultType?e("span",[t._v(t._s(t.titleInfo.titleContent))]):e("img",{attrs:{alt:"",src:t.titleInfo.titleContent},on:{click:function(s){return t.preview(t.titleInfo.titleContent)}}})])]),e("div",{staticClass:"sub_nav"},[e("span",[e("van-tag",{attrs:{mark:"",plain:""}},[t._v(t._s(t.titleInfo.groupName))]),t._v(" 的讨论 ")],1)]),e("div",{ref:"chat",staticClass:"chat"},[t.discussList&&t.discussList.length>0?e("div",{staticClass:"chat_content"},t._l(t.discussList,(function(s,i){return e("div",{key:i,staticClass:"chat_item left_item"},[e("div",{staticClass:"chat_icon"},[e("img",{directives:[{name:"real-img",rawName:"v-real-img",value:[s.userID,s.studentID],expression:"[sub.userID, sub.studentID]"}],attrs:{src:t.defaultHead,alt:""}})]),e("div",{staticClass:"chat_news"},[e("div",{staticClass:"chat_news_name"},[t._v(" "+t._s(s.studentName)+" "),e("span",{staticClass:"time"},[t._v(t._s(s.createTime))]),e("span",{staticClass:"operate"},[e("van-button",{staticClass:"operate_btn",attrs:{size:"mini",disabled:s.score<=0},on:{click:function(e){return t.scoreSet(s,-1)}}},[t._v(" - ")]),e("span",{staticClass:"operate_score"},[t._v(t._s(s.score))]),e("van-button",{staticClass:"operate_btn",attrs:{size:"mini",disabled:s.score>=100},on:{click:function(e){return t.scoreSet(s,1)}}},[t._v(" + ")]),e("span",{staticClass:"score"},[t._v("分")]),e("van-icon",{class:{check:s.good>0},attrs:{name:0===s.good?"good-job-o":"good-job"},on:{click:function(e){return t.goodSet(s)}}})],1)]),e("div",{staticClass:"chat_news_cont"},[s.type===t.defaultType?e("span",[t._v(t._s(s.content))]):e("img",{attrs:{src:s.content,alt:""},on:{click:function(e){return t.preview(s.content)}}}),e("div",{staticClass:"chat_news_arrow"})])])])})),0):e("r-lack-data")],1)],1)},o=[],n=(e("4160"),e("13d5"),e("159b"),e("1e55")),a=e("08f3"),c=e("6828"),r={name:"discussion-info",data:function(){return{titleInfo:this.$route.query,groupList:[],defaultHead:e("a5b7"),selectIndex:0,discussList:[],defaultType:a["a"].Text}},computed:{},mounted:function(){this.getGroupDiscussList()},methods:{getGroupDiscussList:function(){var t=this;this.discussList=[],this.$mainHttp.groupDiscussion.getDataList({gsID:this.titleInfo.id}).then((function(s){s.Result?s.Datas&&s.Datas&&s.Datas.forEach((function(s){t.discussList.push({studentID:s.Key["StudentID"],userID:s["UserID"],studentName:s["StudentName"],id:s.Key["GDID"],type:s.Key["GDForm"],content:s.Key["GDForm"]===a["a"].Text?s.Key["GDContent"]:t.$mainHttp.common.picture(s.Key["GDContent"],a["e"].GroupDiscuss),createTime:Object(c["a"])(s.Key["SubmitTime"],"hh:mm:ss"),good:s.Key["GDGood"]||0,score:s.Key["GDScore"]||0})})):s.Info&&t.$toast(s.Info)})).catch((function(){}))},preview:function(t){this.$store.commit("SET_IMAGE_PREVIEW",t)},scoreSet:function(t,s){var e=this;t.score+=s,this.$mainHttp.groupDiscussion.postSetScore({ciID:this.$store.getters.courseID,groupID:this.titleInfo.groupID,gdID:t.id,gsID:this.titleInfo.id,gdScore:t.score,isAdd:1===s}).then((function(t){t.Result?e.titleInfo.scoreTotal=e.discussList.reduce((function(t,s){return t+parseInt(s.score)}),0):t.Info?e.$toast(t.Info):e.$toast("编辑失败")})).catch((function(){e.$toast("操作失败")}))},goodSet:function(t){var s=this,e=Math.abs(t.good-1);this.$mainHttp.groupDiscussion.postSetGood({ciID:this.$store.getters.courseID,groupID:this.titleInfo.groupID,gdID:t.id,gsID:this.titleInfo.id,gdGood:e}).then((function(i){i.Result?(t.good=e,s.titleInfo.goodTotal=s.discussList.reduce((function(t,s){return t+s.good}),0)):i.Info?s.$toast(i.Info):s.$toast("编辑失败")})).catch((function(){s.$toast("操作失败")}))},toStop:function(){var t=this;n["Dialog"].confirm({title:"提示",message:"是否结束当前所有小组论题？"}).then((function(){t.$mainHttp.groupDiscussion.postSelectStop({gsID:t.titleInfo.id}).then((function(s){s.Result?(t.titleInfo.state=2,t.$toast("结束讨论成功")):s.Info?t.$toast(s.Info):t.$toast("结束讨论失败")})).catch((function(){t.$toast("操作失败")}))})).catch((function(){}))}}},u=r,d=(e("d455"),e("2877")),l=Object(d["a"])(u,i,o,!1,null,"28adc214",null);s["default"]=l.exports},d455:function(t,s,e){"use strict";var i=e("f1f1"),o=e.n(i);o.a},f1f1:function(t,s,e){}}]);