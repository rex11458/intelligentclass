webpackJsonp([45],{AMlE:function(t,e){},Dlep:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=s("UN56"),a=s("FwVa"),n=s("0xDb"),i={name:"",components:{RQuillEditor:o.a},props:{},data:function(){return{snID:this.$route.query&&this.$route.query.snID||"",title:this.$route.query&&this.$route.query.title||"",content:this.$route.query&&this.$route.query.content||"",courseID:this.$route.query&&this.$route.query.courseID||"",courseName:this.$route.query&&this.$route.query.courseName||"",classHourID:this.$route.query&&this.$route.query.classHourID||"",classHourName:this.$route.query&&this.$route.query.classHourName||"",funType:a.h.StudentNote,saveLoading:!1,courseOptions:[{text:"请选择课程",value:""}],showPicker:!1,columns:[{values:[],className:"column1",defaultIndex:0},{values:[],className:"column2"}],courseHours:[],selectLoading:!1}},created:function(){this.loadAllCourse()},mounted:function(){this.$route.query&&this.$route.query.content&&this.$refs.REditor.initValue(this.$route.query.content)},methods:{loadAllCourse:function(){var t=this;this.courseOptions=[{text:"请选择课程",value:""}],this.columns[0].values=[],this.$mainHttp.course.getStudentCourseList({studentID:this.$store.getters.studentID}).then(function(e){e.Result&&e.Datas&&e.Datas.length>0&&(e.Datas.sort(function(t){return t.ClassDate}).reverse(),e.Datas.forEach(function(e){var s={text:""+e.CourseName,value:e.CourseID};t.columns[0].values.push(s)}),t.loadAllClassHour(t.columns[0].values[0].value,null))}).catch(function(t){})},loadAllClassHour:function(t,e){var s=this,o=this.courseOptions.findIndex(function(e){return e.courseID===t});if(o>-1)this.columns[1].values=this.courseOptions[o].values,e&&e.setColumnValues(1,this.courseOptions[o].values);else{var a=[];this.selectLoading=!0,this.$mainHttp.classHour.dataList({courseID:t}).then(function(o){o.Result&&o.Datas&&o.Datas.length>0&&(o.Datas.sort(function(t){return t.CreateTime}).reverse(),o.Datas.forEach(function(t){a.push({text:""+t.CHName,value:t.CHID})}),s.courseOptions.push({courseID:t,values:a}),s.columns[1].values=a,e&&e.setColumnValues(1,a)),s.selectLoading=!1}).catch(function(t){s.selectLoading=!1})}},beforeShow:function(){var t=this;if(this.courseName){var e=this.columns[0].values.findIndex(function(e){return e.text===t.courseName});e>-1?this.loadDefaultClassHour(this.columns[0].values[e].value,e):this.showPicker=!0}else this.showPicker=!0},loadDefaultClassHour:function(t,e){var s=this,o=this.courseOptions.findIndex(function(e){return e.courseID===t});if(o>-1)this.columns[1].values=this.courseOptions[o].values,this.showPicker=!0;else{var a=[];this.$mainHttp.classHour.dataList({courseID:t}).then(function(o){o.Result&&o.Datas&&o.Datas.length>0&&(o.Datas.sort(function(t){return t.CreateTime}).reverse(),o.Datas.forEach(function(t){a.push({text:""+t.CHName,value:t.CHID})}),s.courseOptions.push({courseID:t,values:a}),s.columns[1].values=a,s.columns[0].defaultIndex=e,s.columns[1].defaultIndex=a.findIndex(function(t){return t.value===s.classHourID})),s.showPicker=!0}).catch(function(t){s.showPicker=!0})}},saveData:function(){var t=this;if(!this.saveLoading)return this.saveLoading=!0,this.classHourID?this.title?Object(n.d)(this.title)?(this.$toast("不支持表情字符"),void(this.saveLoading=!1)):this.content?Object(n.d)(this.content)?(this.$toast("不支持表情字符"),void(this.saveLoading=!1)):void this.$mainHttp.note.postSave({snID:this.snID,ciID:this.courseID,chID:this.classHourID,studentID:this.$store.getters.studentID,title:this.title,content:this.content}).then(function(e){e.Result?(t.$toast.success("编辑笔记成功"),t.$router.push("/space/note")):e.Info&&t.$toast(e.Info),t.saveLoading=!1}).catch(function(e){t.$toast("添加失败，请重试"),t.saveLoading=!1}):(this.$toast("笔记内容不能为空"),void(this.saveLoading=!1)):(this.$toast("笔记标题不能为空"),void(this.saveLoading=!1)):(this.$toast("请选择课程"),void(this.saveLoading=!1))},editorChange:function(t){this.content=t},handleChange:function(t,e){this.loadAllClassHour(e[0].value,t)},onConfirm:function(t){this.classHourID=t[1].value,this.classHourName=t[1].text,this.showPicker=!1}}},u={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"edit-note"}},[s("head-top",{attrs:{title:"编辑笔记"}},[s("span",{staticClass:"head-right",attrs:{slot:"right"},on:{click:t.saveData},slot:"right"},[s("i",{staticClass:"iconfont icon-finish"})])]),t._v(" "),s("div",{staticClass:"main"},[s("van-field",{attrs:{readonly:"",clickable:"",placeholder:"请选择课程"},on:{click:t.beforeShow},model:{value:t.classHourName,callback:function(e){t.classHourName=e},expression:"classHourName"}}),t._v(" "),s("van-popup",{attrs:{position:"bottom"},model:{value:t.showPicker,callback:function(e){t.showPicker=e},expression:"showPicker"}},[s("van-picker",{attrs:{id:"coursePicker","show-toolbar":"",columns:t.columns,loading:t.selectLoading,"get-container":"#edit-note"},on:{cancel:function(e){t.showPicker=!1},confirm:t.onConfirm,change:t.handleChange}})],1),t._v(" "),s("van-field",{attrs:{type:"textarea",placeholder:"笔记标题",autosize:"",maxlength:"50","show-word-limit":""},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}}),t._v(" "),s("r-quill-editor",{ref:"REditor",attrs:{"is-class":!1,funType:t.funType,"max-height":"calc(50vh)"},on:{change:t.editorChange}})],1)],1)},staticRenderFns:[]};var r=s("VU/8")(i,u,!1,function(t){s("AMlE")},"data-v-206f6e29",null);e.default=r.exports}});
//# sourceMappingURL=45.359a49f128cf3e21a222.js.map