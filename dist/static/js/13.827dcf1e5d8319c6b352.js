webpackJsonp([13],{"+QnX":function(t,e){},"1pvJ":function(t,e,n){"use strict";var i={name:"task-item",props:{taskItem:{type:Object},state:{type:String,default:"0"}},data:function(){return{}},methods:{handleDownload:function(){this.$emit("download",this.taskItem)},handleDeal:function(){this.$emit("doDeal",this.taskItem)},handleView:function(){this.$emit("doView",this.taskItem)}}},a={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"r-task-item"},[n("div",{staticClass:"item-title"},[n("h3",[t._v(" "+t._s(t.taskItem.Title)+" ")]),t._v(" "),n("div",[1===t.taskItem.Type?n("div",{attrs:{size:"mini"}},[n("van-icon",{attrs:{"class-prefix":"iconfont icon-xiazai"},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.handleDownload(e)}}})],1):"0"===t.state?n("van-button",{attrs:{size:"mini",type:"primary"},on:{click:t.handleDeal}},[t._v("\n        去完成\n      ")]):n("van-button",{attrs:{size:"mini",type:"primary"},on:{click:t.handleView}},[t._v("\n        查看\n      ")])],1)]),t._v(" "),n("div",{staticClass:"item-foot foot-remark"},[n("span",[t._v("\n      "+t._s("1"===t.taskItem.Attribute?"课前":"课后")+"\n    ")]),t._v(" "),n("span",[t._v("\n      "+t._s(1===t.taskItem.Type?"课件":"随堂练习")+"\n    ")]),t._v(" "),n("span",[t._v("\n      "+t._s(t.taskItem.CreateTime.split(" ")[0])+"\n    ")])]),t._v(" "),n("div",{staticClass:"item-foot foot-info"},[n("span",[t._v("\n      "+t._s(t.taskItem.CHName)+"\n    ")]),t._v(" "),n("span",[t._v("\n      老师："+t._s(t.taskItem.TeacherName)+"\n    ")])])])},staticRenderFns:[]},s={name:"task-list",components:{TaskItem:n("VU/8")(i,a,!1,null,null,null).exports},props:{dataList:{type:Array,default:function(){return[]}},state:{type:String,default:"0"}},data:function(){return{}},methods:{handleDownload:function(t){this.$emit("download",t)},handleDeal:function(t){this.$emit("doDeal",t)},handleView:function(t){this.$emit("doView",t)}}},o={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"r-task-list"},t._l(t.dataList,function(e,i){return n("task-item",{key:i,attrs:{"task-item":e,state:t.state},on:{download:t.handleDownload,doDeal:t.handleDeal,doView:t.handleView}})}),1)},staticRenderFns:[]},r=n("VU/8")(s,o,!1,null,null,null).exports;e.a=r},"8Ypc":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n("1pvJ"),a=n("0xDb"),s={name:"homework",components:{TaskList:i.a},props:{typeSelected:{type:Number,default:0}},data:function(){return{emojValidator:a.d,tabSelected:"0",tabOptions:[{label:"未完成",name:"0",taskList:[],pno:0,pageSize:8,total:0,loading:!1,error:!1,finished:!1},{label:"已完成",name:"1",taskList:[],pno:0,pageSize:8,total:0,loading:!1,error:!1,finished:!1}],isLoading:!1}},computed:{},beforeRouteEnter:function(t,e,n){n(function(t){(e.path.indexOf("/practiceView")>-1||e.path.indexOf("/coursewareComment")>-1)&&(t.tabSelected="1")})},mounted:function(){},methods:{init:function(){this.tabOptions=[{label:"未完成",name:"0",taskList:[],pno:0,pageSize:10,total:0,loading:!1,error:!1,finished:!1},{label:"已完成",name:"1",taskList:[],pno:0,pageSize:10,total:0,loading:!1,error:!1,finished:!1}],this.refreshTab("0"===this.tabSelected?0:1)},loadData:function(t){0===t?this.getUnFinishTaskList():this.getFinishedTaskList()},refreshTab:function(t){0===Math.abs(t)?(this.tabOptions[0].taskList.length=0,this.tabOptions[0].pno=0,this.tabOptions[0].total=0,this.tabOptions[0].error=!1,this.tabOptions[0].finished=!1,this.getUnFinishTaskList()):(this.tabOptions[1].taskList.length=0,this.tabOptions[1].pno=0,this.tabOptions[1].total=0,this.tabOptions[1].error=!1,this.tabOptions[1].finished=!1,this.getFinishedTaskList())},handleTabClick:function(t,e){0===Math.abs(t)?0===this.tabOptions[0].taskList.length&&this.getUnFinishTaskList():0===this.tabOptions[1].taskList.length&&this.getFinishedTaskList()},getUnFinishTaskList:function(){var t=this,e=this.tabOptions[0];if(this.isLoading=!0,e.loading=!0,!(0===e.pno||e.total>e.pno*e.pageSize))return this.isLoading=!1,e.loading=!1,void(e.finished=!0);e.pno++,1===e.pno&&(e.taskList=[]);var n={pno:e.pno,psize:e.pageSize,estate:1,stuID:this.$store.getters.studentID};(0===this.typeSelected?this.$mainHttp.classHour.getPracticeTaskList:this.$mainHttp.classHour.getCourseWareTaskList)(n).then(function(n){n.Result&&(e.total=n.rowsCount,n.Datas&&n.Datas.length>0&&n.Datas.forEach(function(t){e.taskList.push(t)})),n.RowsCount&&(e.total=n.RowsCount),e.total<=e.pno*e.pageSize&&(e.finished=!0),e.loading=!1,t.isLoading=!1}).catch(function(){e.error=!0,e.loading=!1,t.isLoading=!1})},getFinishedTaskList:function(){var t=this,e=this.tabOptions[1];if(this.isLoading=!0,e.loading=!0,!(0===e.pno||e.total>e.pno*e.pageSize))return this.isLoading=!1,e.loading=!1,void(e.finished=!0);e.pno++,1===e.pno&&(e.taskList=[]);var n={pno:e.pno,psize:e.pageSize,estate:2,stuID:this.$store.getters.studentID};(0===this.typeSelected?this.$mainHttp.classHour.getPracticeTaskList:this.$mainHttp.classHour.getCourseWareTaskList)(n).then(function(n){n.Result&&(e.total=n.rowsCount,n.Datas&&n.Datas.length>0&&n.Datas.forEach(function(t){e.taskList.push(t)})),n.RowsCount&&(e.total=n.RowsCount),e.total<=e.pno*e.pageSize&&(e.finished=!0),e.loading=!1,t.isLoading=!1}).catch(function(){e.error=!0,e.loading=!1,t.isLoading=!1})},doPractice:function(t){this.$router.push("/space/practiceDone/"+t.CIPID+"/"+t.PLID+"/"+t.CPID+"/"+t.CHID)},download:function(t){var e=this,n=this.$mainHttp.resourse.file(t.MaterialID);window.webkit?sendToAPP(FuncType.downloadFile,n).then(function(n){e.addCoursewareTask(t)}).catch(function(t){}):(window.location.href=n,this.addCoursewareTask(t))},addCoursewareTask:function(t){var e=this;this.$mainHttp.courseware.postCoursewareTask({cID:t.CID,stuID:this.$store.getters.studentID}).then(function(t){t.Result&&(e.$toast("数据下载成功！"),e.refreshTab(0))}).catch(function(t){})},viewPractice:function(t){this.$router.push("/space/practiceView/"+t.CIPID+"/"+t.PLID+"/"+t.CPID+"/"+t.CHID)},comment:function(t){this.$router.push("/space/coursewareComment/"+t.CID+"/"+t.CourseID)}}},o={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"home-work"},[n("van-tabs",{on:{change:t.handleTabClick},model:{value:t.tabSelected,callback:function(e){t.tabSelected=e},expression:"tabSelected"}},t._l(t.tabOptions,function(e,i){return n("van-tab",{key:i,attrs:{title:e.label,name:e.name}},[n("van-pull-refresh",{staticClass:"pull_fresh",on:{refresh:function(e){return t.refreshTab(i)}},model:{value:t.isLoading,callback:function(e){t.isLoading=e},expression:"isLoading"}},[n("van-list",{attrs:{finished:e.finished,"finished-text":"没有更多了",error:e.error,"error-text":"请求失败，点击重新加载"},on:{"update:error":function(n){return t.$set(e,"error",n)},load:function(e){return t.loadData(i)}},model:{value:e.loading,callback:function(n){t.$set(e,"loading",n)},expression:"tab.loading"}},[e.taskList&&e.taskList.length>0?n("task-list",{attrs:{"data-list":e.taskList,state:t.tabSelected},on:{download:t.download,doDeal:t.doPractice,doView:t.viewPractice}}):t._e()],1)],1)],1)}),1)],1)},staticRenderFns:[]};var r={name:"homework",components:{homeworkList:n("VU/8")(s,o,!1,function(t){n("tl0H")},"data-v-09c28378",null).exports},data:function(){return{emojValidator:a.d,tabSelected:"0",tabOptions:[{label:"未完成",name:"0",taskList:[],pno:0,pageSize:8,total:0,loading:!1,error:!1,finished:!1},{label:"已完成",name:"1",taskList:[],pno:0,pageSize:8,total:0,loading:!1,error:!1,finished:!1}],isLoading:!1,activeIndex:0,items:[{text:"随堂练习"},{text:"课件"}],reqFunc:null}},computed:{},beforeRouteEnter:function(t,e,n){n(function(t){(e.path.indexOf("/practiceView")>-1||e.path.indexOf("/coursewareComment")>-1)&&(t.tabSelected="1")})},mounted:function(){},methods:{treeChanged:function(t){var e=this;setTimeout(function(){e.$refs["tree"+t].init()},100)}}},l={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"home-work"}},[n("head-top",{attrs:{title:"我的任务"}}),t._v(" "),n("van-tree-select",{attrs:{height:"calc(100vh - 4.3rem)",items:t.items,"main-active-index":t.activeIndex},on:{"update:mainActiveIndex":function(e){t.activeIndex=e},"update:main-active-index":function(e){t.activeIndex=e},"click-nav":t.treeChanged}},[n("template",{slot:"content"},[0===t.activeIndex?n("homework-list",{ref:"tree0",attrs:{"type-selected":0}}):n("homework-list",{ref:"tree1",attrs:{"type-selected":1}})],1)],2)],1)},staticRenderFns:[]};var d=n("VU/8")(r,l,!1,function(t){n("+QnX")},"data-v-1311983e",null);e.default=d.exports},tl0H:function(t,e){}});
//# sourceMappingURL=13.827dcf1e5d8319c6b352.js.map