{"version":3,"sources":["webpack:///src/pages/course/group/groupDiscussion.vue","webpack:///./src/pages/course/group/groupDiscussion.vue?a371","webpack:///./src/pages/course/group/groupDiscussion.vue","webpack:///./src/components/r-image/index.js"],"names":["groupDiscussion","name","components","RImage","r_image","props","data","defaultHead","__webpack_require__","total","contentType","utils_enum","Text","contentTypeDefault","content","imgBase","showEdit","discussionSubject","discussionContents","computed","groupName","this","$store","getters","group","score","forEach","r","good","created","getDataStatics","getDataDetail","mounted","_this","$nextTick","window","uploadImage","imgFile","afterRead","methods","preview","image","commit","_this2","$mainHttp","getStatisticByGroup","groupID","then","res","Result","Total","catch","_this3","getDataInfoByGroup","Datas","length","sort","a","b","SubmitTime","sub","subIndex","findIndex","push","$refs","scrollTop","chat","scrollHeight","setTimeout","splice","dataAdd","_this4","postDataSave","ciID","courseID","gsID","studentID","gdForm","gdContent","Info","$toast","getDiscussionImage","fileId","common","picture","GroupSubject","getImageFile","GroupDiscuss","selectPhoto","type","Object","interFlow","cameraOpen","albumOpen","file","_this5","console","log","reqData","funType","imgBaseString","pictureUpload","Picture","Data","watch","$store.getters.groupDiscussion","newVal","oldVal","init","newMsg","_this6","group_groupDiscussion","render","_vm","_h","$createElement","_c","_self","attrs","id","title","staticClass","to","_v","_s","ref","style","maxWidth","maxHeight","alt","src","on","click","$event","_e","directives","rawName","value","expression","_l","k","key","class","disabled","placeholder","domProps","keyup","indexOf","_k","keyCode","input","target","composing","size","staticRenderFns","Component","normalizeComponent","ssrContext","__webpack_exports__","__WEBPACK_IMPORTED_MODULE_0__r_image_vue__","Image"],"mappings":"gJAgFAA,GACAC,KAAA,GACAC,YAAAC,OAAAC,EAAA,GACAC,SACAC,KAJA,WAKA,OACAC,YAAAC,EAAA,QAEAC,MAAA,EAEAC,YAAAC,EAAA,EAAAC,KACAC,mBAAAF,EAAA,EAAAC,KACAE,QAAA,GACAC,QAAA,GAEAC,UAAA,EAEAC,kBAAA,KACAC,wBAGAC,UACAC,UADA,WAEA,OAAAC,KAAAC,OAAAC,QAAAC,OACAH,KAAAC,OAAAC,QAAAC,MAAAJ,WAEA,QAGAK,MARA,WASA,IAAAA,EAAA,EAIA,OAHAJ,KAAAH,mBAAAQ,QAAA,SAAAC,GACAF,GAAAE,EAAA,UAEAF,GAEAG,KAfA,WAgBA,IAAAA,EAAA,EAIA,OAHAP,KAAAH,mBAAAQ,QAAA,SAAAC,GACAC,GAAAD,EAAA,aAEAC,IAGAC,QA5CA,WA6CAR,KAAAS,iBACAT,KAAAU,iBAEAC,QAhDA,WAgDA,IAAAC,EAAAZ,KACAA,KAAAa,UAAA,WACAC,OAAAC,YAAA,SAAAC,GACAJ,EAAAK,UAAAD,OAIAE,SACAC,QADA,SACAC,GACApB,KAAAC,OAAAoB,OAAA,oBAAAD,IAEAX,eAJA,WAIA,IAAAa,EAAAtB,KACAA,KAAAuB,UAAA5C,gBAAA6C,qBACAC,QAAAzB,KAAAC,OAAAC,QAAAuB,UACAC,KAAA,SAAAC,GACAA,EAAAC,SAEAN,EAAAlC,MAAAuC,EAAAE,OAAA,KAGAC,MAAA,eAGApB,cAhBA,WAgBA,IAAAqB,EAAA/B,KAEAA,KAAAuB,UAAA5C,gBAAAqD,oBACAP,QAAAzB,KAAAC,OAAAC,QAAAuB,UACAC,KAAA,SAAAC,GACAA,EAAAC,QAAAD,EAAAM,OAAAN,EAAAM,MAAAC,OAAA,IACAH,EAAAnC,kBAAA+B,EAAAM,MAAA,OAEAN,EAAAM,MAAA,SAAAE,KAAA,SAAAC,EAAAC,GACA,OAAAD,EAAAE,WAAAD,EAAAC,YACA,EAEA,IAGAX,EAAAM,MAAA,SAAA5B,QAAA,SAAAkC,GACA,IAAAC,EAAAT,EAAAlC,mBAAA4C,UAAA,SAAAnC,GACA,OAAAA,EAAA,OAAAiC,EAAA,QAGA,IAAAC,GACAT,EAAAlC,mBAAA6C,KAAAH,GACAR,EAAAlB,UAAA,WACAkB,EAAAY,MAAA,OAKAZ,EAAAY,MAAA,KAAAC,UAAAb,EAAAY,MAAAE,KAAAC,aACAC,WAAA,WACAhB,EAAAY,MAAA,KAAAC,UAAAb,EAAAY,MAAAE,KAAAC,cACA,SAGAf,EAAAlC,mBAAAmD,OAAAR,EAAA,EAAAD,QAIAT,MAAA,eAGAmB,QAzDA,WAyDA,IAAAC,EAAAlD,KACAA,KAAAP,SAGAO,KAAAuB,UAAA5C,gBAAAwE,cACAC,KAAApD,KAAAC,OAAAC,QAAAmD,SACAC,KAAAtD,KAAAJ,kBAAA,KACA2D,UAAAvD,KAAAC,OAAAC,QAAAqD,UACA9B,QAAAzB,KAAAC,OAAAC,QAAAuB,QACA+B,OAAAxD,KAAAX,YACAoE,UAAAzD,KAAAP,UACAiC,KAAA,SAAAC,GACAA,EAAAC,QACAsB,EAAAzD,QAAA,GACAyD,EAAA7D,YAAA6D,EAAA1D,oBACAmC,EAAA+B,MACAR,EAAAS,OAAAhC,EAAA+B,QAEA5B,MAAA,eAGA8B,mBA9EA,SA8EAC,GACA,OAAA7D,KAAAuB,UAAAuC,OAAAC,QAAAF,EAAAvE,EAAA,EAAA0E,eAEAC,aAjFA,SAiFAJ,GACA,OAAA7D,KAAAuB,UAAAuC,OAAAC,QAAAF,EAAAvE,EAAA,EAAA4E,eAEAC,YApFA,SAoFAC,GACApE,KAAAJ,oBACA,IAAAwE,EACQC,OAAAC,EAAA,EAAAD,CAARC,EAAA,EAAAC,WAAA,IAEQF,OAAAC,EAAA,EAAAD,CAARC,EAAA,EAAAE,UAAA,MAGAvD,UA5FA,SA4FAwD,GAAA,IAAAC,EAAA1E,KAGA,GAFA2E,QAAAC,IAAA,cAAAH,GAEAA,EAAAvC,OAAA,SAEA,OADAlC,KAAA2D,OAAA,gBACA,EAEA,GAAAc,EAAA,CACA,IAAAI,GACAC,QAAAxF,EAAA,EAAA4E,aACAa,cAAAN,GAEAzE,KAAAuB,UAAAuC,OAAAkB,cAAAH,GAAAnD,KAAA,SAAAC,GACAA,EAAAC,SACA8C,EAAArF,YAAAC,EAAA,EAAA2F,QACAP,EAAAhF,QAAA+E,EACAC,EAAAjF,QAAAkC,EAAAuD,KACAR,EAAAzB,aAEAnB,MAAA,iBAKAqD,OACAC,iCADA,SACAC,EAAAC,GACAD,IAAAC,IACAD,EAAAjB,OAAA9E,EAAA,EAAAiG,MACAvF,KAAAS,iBACAT,KAAAU,gBACAV,KAAAJ,kBAAA,KACAI,KAAAH,uBACAwF,EAAAjB,OAAA9E,EAAA,EAAAkG,OACAxF,KAAAU,gBACA2E,EAAAjB,OAAA9E,EAAA,EAAAiB,KAEAP,KAAAU,gBACA2E,EAAAjB,OAAA9E,EAAA,EAAAc,OAEAJ,KAAAU,kBAIAb,mBAnBA,SAmBAwF,EAAAC,GAAA,IAAAG,EAAAzF,KAEAqF,EAAAnD,SAAAoD,EAAApD,QACAlC,KAAAa,UAAA,WACA4E,EAAA9C,MAAA,KAAAC,UAAA6C,EAAA9C,MAAA,KAAAG,aACAC,WAAA,WACA0C,EAAA9C,MAAA,KAAAC,UAAA6C,EAAA9C,MAAA,KAAAG,cACA,UClRe4C,GADEC,OAFjB,WAA0B,IAAAC,EAAA5F,KAAa6F,EAAAD,EAAAE,eAA0BC,EAAAH,EAAAI,MAAAD,IAAAF,EAAwB,OAAAE,EAAA,OAAiBE,OAAOC,GAAA,sBAAyBH,EAAA,YAAiBE,OAAOE,MAAAP,EAAA7F,aAAuBgG,EAAA,eAAoBK,YAAA,aAAAH,OAAgCI,GAAA,cAAAT,EAAAhG,kBAAAgG,EAAAhG,kBAAA,YAAkFmG,EAAA,KAAUK,YAAA,+BAAsC,GAAAR,EAAAU,GAAA,KAAAP,EAAA,OAA8BK,YAAA,YAAsBL,EAAA,OAAAH,EAAAU,GAAA,uBAAAP,EAAA,QAAAH,EAAAU,GAAAV,EAAAW,GAAAX,EAAAxG,YAAAwG,EAAAU,GAAA,KAAAP,EAAA,OAAAH,EAAAU,GAAA,wBAAAP,EAAA,QAAAH,EAAAU,GAAAV,EAAAW,GAAAX,EAAAxF,YAAAwF,EAAAU,GAAA,KAAAP,EAAA,OAAAH,EAAAU,GAAA,wBAAAP,EAAA,QAAAH,EAAAU,GAAAV,EAAAW,GAAAX,EAAArF,aAAAqF,EAAAU,GAAA,KAAAP,EAAA,OAAsSS,IAAA,OAAAJ,YAAA,SAA8BR,EAAA,kBAAAG,EAAA,OAAoCK,YAAA,eAAyBL,EAAA,QAAaK,YAAA,oBAA8BR,EAAAU,GAAA,UAAAV,EAAAU,GAAA,KAAAV,EAAAhG,kBAAA,SAAAgG,EAAApG,mBAAAuG,EAAA,QAAAH,EAAAU,GAAAV,EAAAW,GAAAX,EAAAhG,kBAAA,cAAAmG,EAAA,OAAsKU,OAAQC,SAAA,OAAAC,UAAA,SAAuCV,OAASW,IAAA,GAAAC,IAAAjB,EAAAhC,mBAAAgC,EAAAhG,kBAAA,YAA0EkH,IAAKC,MAAA,SAAAC,GAAyBpB,EAAAzE,QAAAyE,EAAAhC,mBAAAgC,EAAAhG,kBAAA,kBAA0EgG,EAAAqB,KAAArB,EAAAU,GAAA,KAAAP,EAAA,OAAmCmB,aAAatI,KAAA,OAAAuI,QAAA,SAAAC,MAAAxB,EAAA/F,oBAAA+F,EAAA/F,mBAAAqC,OAAA,EAAAmF,WAAA,wDAAkKjB,YAAA,gBAA6BR,EAAA0B,GAAA1B,EAAA,4BAAArD,EAAAgF,GAAiD,OAAAxB,EAAA,OAAiByB,IAAAD,EAAAE,MAAAlF,EAAA,YAAAqD,EAAA3F,OAAAC,QAAAqD,UAAA,+CAA+GwC,EAAA,OAAYK,YAAA,cAAwBL,EAAA,OAAYmB,aAAatI,KAAA,WAAAuI,QAAA,aAAAC,OAAA7E,EAAA,OAAAA,EAAA,WAAA8E,WAAA,wCAAkIpB,OAASY,IAAAjB,EAAA1G,YAAA0H,IAAA,QAAgChB,EAAAU,GAAA,KAAAP,EAAA,OAA0BK,YAAA,cAAwBL,EAAA,OAAYK,YAAA,mBAA6BR,EAAAU,GAAAV,EAAAW,GAAAhE,EAAA,gBAAAqD,EAAAU,GAAA,KAAAP,EAAA,OAA6DK,YAAA,mBAA6B7D,EAAA,SAAAqD,EAAApG,mBAAAuG,EAAA,QAAAH,EAAAU,GAAAV,EAAAW,GAAAhE,EAAA,cAAAwD,EAAA,OAAqGE,OAAOY,IAAAjB,EAAA3B,aAAA1B,EAAA,WAAAqE,IAAA,IAAkDE,IAAKC,MAAA,SAAAC,GAAyBpB,EAAAzE,QAAAyE,EAAA3B,aAAA1B,EAAA,gBAAkDqD,EAAAU,GAAA,KAAAP,EAAA,OAAwBK,YAAA,4BAAsC,KAAAR,EAAAU,GAAA,KAAAP,EAAA,OAA6BmB,aAAatI,KAAA,OAAAuI,QAAA,SAAAC,MAAAxB,EAAA,kBAAAyB,WAAA,sBAA0FjB,YAAA,WAAuBL,EAAA,OAAYK,YAAA,gBAA0BL,EAAA,SAAcmB,aAAatI,KAAA,QAAAuI,QAAA,UAAAC,MAAAxB,EAAA,QAAAyB,WAAA,YAAwEpB,OAAS7B,KAAA,OAAAsD,UAAA9B,EAAAhG,kBAAA+H,YAAA,WAAwEC,UAAWR,MAAAxB,EAAA,SAAsBkB,IAAKe,MAAA,SAAAb,GAAyB,OAAAA,EAAA5C,KAAA0D,QAAA,QAAAlC,EAAAmC,GAAAf,EAAAgB,QAAA,WAAAhB,EAAAQ,IAAA,SAAsF,KAAe5B,EAAA3C,QAAA+D,IAA2BiB,MAAA,SAAAjB,GAA0BA,EAAAkB,OAAAC,YAAsCvC,EAAAnG,QAAAuH,EAAAkB,OAAAd,aAAkCxB,EAAAU,GAAA,SAAAV,EAAAnG,QAAAyC,OAAA6D,EAAA,OAAqDK,YAAA,UAAoBL,EAAA,KAAUK,YAAA,uBAAAH,OAA0CyB,UAAA9B,EAAAhG,mBAAkCkH,IAAKC,MAAA,SAAAC,GAAyB,OAAApB,EAAAzB,YAAA,OAA4ByB,EAAAU,GAAA,KAAAP,EAAA,KAAsBK,YAAA,2BAAAH,OAA8CyB,UAAA9B,EAAAhG,mBAAkCkH,IAAKC,MAAA,SAAAC,GAAyB,OAAApB,EAAAzB,YAAA,SAA4B4B,EAAA,OAAcK,YAAA,UAAoBL,EAAA,cAAmBE,OAAOmC,KAAA,QAAAhE,KAAA,WAAgC0C,IAAKC,MAAAnB,EAAA3C,WAAqB2C,EAAAU,GAAA,mBAE57G+B,oBCCjB,IAcAC,EAdyBnJ,EAAQ,OAcjCoJ,CACE5J,EACA+G,GATF,EAVA,SAAA8C,GACErJ,EAAQ,SAaV,kBAEA,MAUesJ,EAAA,QAAAH,EAAiB,gEC1BhC,IAAAI,EAAAvJ,EAAA,QACewJ,MAAf","file":"static/js/20.c6b315b49e0c1fb88544.js","sourcesContent":["<template>\n  <div id=\"group-discussion\">\n    <head-top :title=\"groupName\">\n      <router-link :to=\"'/teamRank/' + (discussionSubject ? discussionSubject['GSID'] : '')\" class=\"head-right\">\n        <i class=\"iconfont icon-chengyuan\"></i>\n      </router-link>\n    </head-top>\n\n    <!-- 头部摘要 -->\n    <div class=\"summary\">\n      <div>\n        论题:\n        <span>{{ total }}</span>\n      </div>\n      <div>\n        得分数:\n        <span>{{ score }}</span>\n      </div>\n      <div>\n        点赞数:\n        <span>{{ good }}</span>\n      </div>\n    </div>\n\n    <!-- 聊天信息 -->\n    <div class=\"chat\" ref=\"chat\">\n      <div class=\"chat_title\" v-if=\"discussionSubject\">\n        <span class=\"chat_title_left\">[论题]</span>\n        <span\n          v-if=\"discussionSubject['GSForm'] === contentTypeDefault\">{{ discussionSubject[\"GSContent\"] }}</span>\n        <img v-else alt=\"\" :src=\"getDiscussionImage(discussionSubject['GSContent'])\"\n             :style=\"{ maxWidth: '70vw', maxHeight: '15rem' }\"\n             @click=\"preview(getDiscussionImage(discussionSubject['GSContent']))\"/>\n      </div>\n\n      <div v-show=\"discussionContents && discussionContents.length > 0\" class=\"chat_content\">\n        <div v-for=\"(sub, k) in discussionContents\" :key=\"k\"\n             :class=\"sub['StudentID'] !== $store.getters.studentID ? 'chat_item left_item' : 'chat_item right_item'\">\n          <div class=\"chat_icon\">\n            <!-- {{sub['StudentPhoto']}} -->\n            <img :src=\"defaultHead\" v-real-img=\"[ sub['UserID'], sub['StudentID'] ]\" alt/>\n          </div>\n\n          <div class=\"chat_news\">\n            <div class=\"chat_news_name\">{{ sub[\"StudentName\"] }}</div>\n            <div class=\"chat_news_cont\">\n              <span v-if=\"sub['GDForm'] === contentTypeDefault\">{{ sub[\"GDContent\"] }}</span>\n              <img v-else :src=\"getImageFile(sub['GDContent'])\" alt\n                   @click=\"preview(getImageFile(sub['GDContent']))\"/>\n              <div class=\"chat_news_arrow\"></div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <!-- 输入框 -->\n    <div class=\"footer\" v-show=\"discussionSubject\">\n      <div class=\"footer_text\">\n        <input type=\"text\" v-model=\"content\" :disabled=\"!discussionSubject\" placeholder=\"请输入讨论内容\"\n               @keyup.enter=\"dataAdd\"/>\n      </div>\n      <div class=\"icons\" v-if=\"content.length === 0\">\n        <i class=\"iconfont icon-tupian\" :disabled=\"!discussionSubject\" @click=\"selectPhoto(1)\"></i>\n        <i class=\"iconfont icon-photograph\" :disabled=\"!discussionSubject\"\n           @click=\"selectPhoto(2)\"></i>\n      </div>\n      <div class=\"icons\" v-else>\n        <van-button size=\"small\" type=\"primary\" @click=\"dataAdd\">发送</van-button>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport RImage from \"@/components/r-image\";\n\nimport { ContentType, ModulePicture, DiscussFunc } from \"@/utils/enum\";\nimport { FuncType, sendToAPP } from \"@/utils/interFlow\";\n\nexport default {\n  name: \"\",\n  components: { RImage },\n  props: {},\n  data () {\n    return {\n      defaultHead: require(\"./../../../assets/default_head.png\"),\n      // score: 0,\n      total: 0,\n      // good: 0,\n      contentType: ContentType.Text, //1文本 2图片\n      contentTypeDefault: ContentType.Text,\n      content: \"\",\n      imgBase: \"\",\n\n      showEdit: false,\n\n      discussionSubject: null,\n      discussionContents: []\n    };\n  },\n  computed: {\n    groupName () {\n      if (this.$store.getters.group) {\n        return this.$store.getters.group.groupName || \"暂无组名\"\n      } else {\n        return \"暂无组名\";\n      }\n    },\n    score () {\n      let score = 0;\n      this.discussionContents.forEach(r => {\n        score += r[\"GDScore\"];\n      });\n      return score;\n    },\n    good () {\n      let good = 0;\n      this.discussionContents.forEach(r => {\n        good += r[\"GDGood\"] ? 1 : 0;\n      });\n      return good;\n    }\n  },\n  created () {\n    this.getDataStatics();\n    this.getDataDetail();\n  },\n  mounted () {\n    this.$nextTick(() => {\n      window.uploadImage = imgFile => {\n        this.afterRead(imgFile);\n      };\n    });\n  },\n  methods: {\n    preview (image) {\n      this.$store.commit(\"SET_IMAGE_PREVIEW\", image);\n    },\n    getDataStatics () {\n      this.$mainHttp.groupDiscussion.getStatisticByGroup({\n        groupID: this.$store.getters.groupID\n      }).then(res => {\n        if (res.Result) {\n          // this.score = res.Score || 0;\n          this.total = res.Total || 0;\n          // this.good = res.Good || 0;\n        }\n      }).catch(() => {\n      });\n    },\n    getDataDetail () {\n      // this.dataList = [];\n      this.$mainHttp.groupDiscussion.getDataInfoByGroup({\n        groupID: this.$store.getters.groupID\n      }).then(res => {\n        if (res.Result && res.Datas && res.Datas.length > 0) {\n          this.discussionSubject = res.Datas[0][\"Key\"];\n\n          res.Datas[0][\"Value\"].sort((a, b) => {\n            if (a.SubmitTime < b.SubmitTime) {\n              return -1;\n            } else {\n              return 1;\n            }\n          });\n          res.Datas[0][\"Value\"].forEach(sub => {\n            let subIndex = this.discussionContents.findIndex(r => {\n              return r[\"GDID\"] === sub[\"GDID\"];\n              // return JSON.stringify(r) === JSON.stringify(sub);\n            });\n            if (subIndex === -1) {\n              this.discussionContents.push(sub);\n              this.$nextTick(() => {\n                if (!this.$refs[\"chat\"]) return;\n                // console.log(\n                //   this.$refs.chat.scrollHeight,\n                //   this.$refs[\"chat\"].scrollTop\n                // );\n                this.$refs[\"chat\"].scrollTop = this.$refs.chat.scrollHeight;\n                setTimeout(() => {\n                  this.$refs[\"chat\"].scrollTop = this.$refs.chat.scrollHeight;\n                }, 1000);\n              });\n            } else {\n              this.discussionContents.splice(subIndex, 1, sub);\n            }\n          });\n        }\n      }).catch(() => {\n      });\n    },\n    dataAdd () {\n      if (!this.content) {\n        return;\n      }\n      this.$mainHttp.groupDiscussion.postDataSave({\n        ciID: this.$store.getters.courseID,\n        gsID: this.discussionSubject[\"GSID\"],\n        studentID: this.$store.getters.studentID,\n        groupID: this.$store.getters.groupID, // \"19062313411770094101179090842305\" ||\n        gdForm: this.contentType,\n        gdContent: this.content\n      }).then(res => {\n        if (res.Result) {\n          this.content = \"\";\n          this.contentType = this.contentTypeDefault;\n        } else if (res.Info) {\n          this.$toast(res.Info);\n        }\n      }).catch(() => {\n      });\n    },\n    getDiscussionImage (fileId) {\n      return this.$mainHttp.common.picture(fileId, ModulePicture.GroupSubject);\n    },\n    getImageFile (fileId) {\n      return this.$mainHttp.common.picture(fileId, ModulePicture.GroupDiscuss);\n    },\n    selectPhoto (type) {\n      if (!this.discussionSubject) return;\n      if (type === 2) {\n        sendToAPP(FuncType.cameraOpen, \"\");\n      } else {\n        sendToAPP(FuncType.albumOpen, \"\");\n      }\n    },\n    afterRead (file) {\n      console.log(\"接收到的base64：\", file);\n      // 超过20M\n      if (file.length > 1024 * 1024 * 20) {\n        this.$toast(\"请上传小于20M的图片\");\n        return false;\n      }\n      if (file) {\n        let reqData = {\n          funType: ModulePicture.GroupDiscuss,\n          imgBaseString: file\n        };\n        this.$mainHttp.common.pictureUpload(reqData).then(res => {\n          if (res.Result) {\n            this.contentType = ContentType.Picture;\n            this.imgBase = file;\n            this.content = res.Data;\n            this.dataAdd();\n          }\n        }).catch(() => {\n        });\n      }\n    }\n  },\n  watch: {\n    \"$store.getters.groupDiscussion\" (newVal, oldVal) {\n      if (newVal !== oldVal) {\n        if (newVal.type === DiscussFunc.init) {\n          this.getDataStatics();\n          this.getDataDetail();\n          this.discussionSubject = null;\n          this.discussionContents = [];\n        } else if (newVal.type === DiscussFunc.newMsg) {\n          this.getDataDetail();\n        } else if (newVal.type === DiscussFunc.good) {\n          // this.good += newVal.value[\"IsGood\"] ? 1 : -1;\n          this.getDataDetail();\n        } else if (newVal.type === DiscussFunc.score) {\n          // this.score += newVal.value[\"IsAdd\"] ? 1 : -1;\n          this.getDataDetail();\n        }\n      }\n    },\n    discussionContents (newVal, oldVal) {\n      // setTimeout(() => {\n      if (newVal.length === oldVal.length) return;\n      this.$nextTick(() => {\n        this.$refs[\"chat\"].scrollTop = this.$refs[\"chat\"].scrollHeight;\n        setTimeout(() => {\n          this.$refs[\"chat\"].scrollTop = this.$refs[\"chat\"].scrollHeight;\n        }, 1000);\n      });\n      // }, 200);\n    }\n  }\n};\n</script>\n\n<style lang=\"less\" scoped>\n@import url(\"./../../../styles/common/base.less\");\n\n@footHeight: 40px;\n#group-discussion {\n  width: 100%;\n  min-height: calc(100% - 44px);\n  margin-bottom: 40px;\n  background: #ebf0ef;\n\n  .summary {\n    width: 93vw;\n    height: 45px;\n    padding: 0 3.5vw;\n    background: #fff;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n\n    font-size: @font-sub-title;\n    font-family: MicrosoftYaHei;\n    color: rgba(153, 153, 153, 1);\n    line-height: 45px;\n\n    span {\n      font-size: @font-title * 1.3;\n      font-family: DINPro-Regular;\n      color: rgba(240, 122, 35, 1);\n    }\n  }\n\n  .chat {\n    height: calc(100vh - 44px - 45px - @footHeight);\n    overflow-y: auto;\n  }\n\n  .footer {\n    position: fixed;\n    left: 0;\n    bottom: 0;\n    width: 100vw;\n    height: @footHeight;\n    background: rgba(255, 255, 255, 1);\n    overflow: hidden;\n    text-align: left;\n\n    .footer_text {\n      width: 75vw;\n      margin: 0 2.5vw;\n\n      float: left;\n      text-align: left;\n      border: none;\n\n      input {\n        background: rgba(235, 240, 239, 1);\n        font-size: @font-sub-title;\n        color: rgba(153, 153, 153, 1);\n        width: 100%;\n        height: @footHeight - 10px;\n        line-height: @footHeight - 10px;\n        margin-top: 5px;\n        padding-left: 2vw;\n      }\n    }\n\n    .icons {\n      width: 18vw;\n      float: left;\n      padding-left: 2vw;\n\n      .iconfont {\n        font-size: @font-title * 1.5;\n        line-height: @footHeight;\n      }\n\n      .van-button {\n        line-height: @footHeight - 10px;\n        height: @footHeight - 10px;\n        font-size: @font-sub-title;\n        padding: 0 2vw;\n        margin: 5px auto;\n      }\n    }\n  }\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/pages/course/group/groupDiscussion.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"group-discussion\"}},[_c('head-top',{attrs:{\"title\":_vm.groupName}},[_c('router-link',{staticClass:\"head-right\",attrs:{\"to\":'/teamRank/' + (_vm.discussionSubject ? _vm.discussionSubject['GSID'] : '')}},[_c('i',{staticClass:\"iconfont icon-chengyuan\"})])],1),_vm._v(\" \"),_c('div',{staticClass:\"summary\"},[_c('div',[_vm._v(\"\\n      论题:\\n      \"),_c('span',[_vm._v(_vm._s(_vm.total))])]),_vm._v(\" \"),_c('div',[_vm._v(\"\\n      得分数:\\n      \"),_c('span',[_vm._v(_vm._s(_vm.score))])]),_vm._v(\" \"),_c('div',[_vm._v(\"\\n      点赞数:\\n      \"),_c('span',[_vm._v(_vm._s(_vm.good))])])]),_vm._v(\" \"),_c('div',{ref:\"chat\",staticClass:\"chat\"},[(_vm.discussionSubject)?_c('div',{staticClass:\"chat_title\"},[_c('span',{staticClass:\"chat_title_left\"},[_vm._v(\"[论题]\")]),_vm._v(\" \"),(_vm.discussionSubject['GSForm'] === _vm.contentTypeDefault)?_c('span',[_vm._v(_vm._s(_vm.discussionSubject[\"GSContent\"]))]):_c('img',{style:({ maxWidth: '70vw', maxHeight: '15rem' }),attrs:{\"alt\":\"\",\"src\":_vm.getDiscussionImage(_vm.discussionSubject['GSContent'])},on:{\"click\":function($event){_vm.preview(_vm.getDiscussionImage(_vm.discussionSubject['GSContent']))}}})]):_vm._e(),_vm._v(\" \"),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.discussionContents && _vm.discussionContents.length > 0),expression:\"discussionContents && discussionContents.length > 0\"}],staticClass:\"chat_content\"},_vm._l((_vm.discussionContents),function(sub,k){return _c('div',{key:k,class:sub['StudentID'] !== _vm.$store.getters.studentID ? 'chat_item left_item' : 'chat_item right_item'},[_c('div',{staticClass:\"chat_icon\"},[_c('img',{directives:[{name:\"real-img\",rawName:\"v-real-img\",value:([ sub['UserID'], sub['StudentID'] ]),expression:\"[ sub['UserID'], sub['StudentID'] ]\"}],attrs:{\"src\":_vm.defaultHead,\"alt\":\"\"}})]),_vm._v(\" \"),_c('div',{staticClass:\"chat_news\"},[_c('div',{staticClass:\"chat_news_name\"},[_vm._v(_vm._s(sub[\"StudentName\"]))]),_vm._v(\" \"),_c('div',{staticClass:\"chat_news_cont\"},[(sub['GDForm'] === _vm.contentTypeDefault)?_c('span',[_vm._v(_vm._s(sub[\"GDContent\"]))]):_c('img',{attrs:{\"src\":_vm.getImageFile(sub['GDContent']),\"alt\":\"\"},on:{\"click\":function($event){_vm.preview(_vm.getImageFile(sub['GDContent']))}}}),_vm._v(\" \"),_c('div',{staticClass:\"chat_news_arrow\"})])])])}),0)]),_vm._v(\" \"),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.discussionSubject),expression:\"discussionSubject\"}],staticClass:\"footer\"},[_c('div',{staticClass:\"footer_text\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.content),expression:\"content\"}],attrs:{\"type\":\"text\",\"disabled\":!_vm.discussionSubject,\"placeholder\":\"请输入讨论内容\"},domProps:{\"value\":(_vm.content)},on:{\"keyup\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }return _vm.dataAdd($event)},\"input\":function($event){if($event.target.composing){ return; }_vm.content=$event.target.value}}})]),_vm._v(\" \"),(_vm.content.length === 0)?_c('div',{staticClass:\"icons\"},[_c('i',{staticClass:\"iconfont icon-tupian\",attrs:{\"disabled\":!_vm.discussionSubject},on:{\"click\":function($event){return _vm.selectPhoto(1)}}}),_vm._v(\" \"),_c('i',{staticClass:\"iconfont icon-photograph\",attrs:{\"disabled\":!_vm.discussionSubject},on:{\"click\":function($event){return _vm.selectPhoto(2)}}})]):_c('div',{staticClass:\"icons\"},[_c('van-button',{attrs:{\"size\":\"small\",\"type\":\"primary\"},on:{\"click\":_vm.dataAdd}},[_vm._v(\"发送\")])],1)])],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-31df97e0\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/pages/course/group/groupDiscussion.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true,\\\"publicPath\\\":\\\"../../\\\"}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-31df97e0\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!less-loader?{\\\"sourceMap\\\":true}!../../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./groupDiscussion.vue\")\n}\nvar normalizeComponent = require(\"!../../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./groupDiscussion.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./groupDiscussion.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-31df97e0\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../../node_modules/vue-loader/lib/selector?type=template&index=0!./groupDiscussion.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-31df97e0\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/pages/course/group/groupDiscussion.vue\n// module id = null\n// module chunks = ","import Image from './r-image.vue';\r\nexport default Image;\n\n\n// WEBPACK FOOTER //\n// ./src/components/r-image/index.js"],"sourceRoot":""}